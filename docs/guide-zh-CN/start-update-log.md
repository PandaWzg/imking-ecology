## 更新历史

升级说明：  

> 创建一个Git版本库，并创建二个分支比如A、B，A分支默认为你的二开分支、B分支为你的版本库分支。  
> 等需要升级的时候，把版本库分支(B)升级为最新的版本，然后切换到A分支，把B分支合并过来，解决掉合并冲突即可。

注意：

> 各个小版本升级例如 2.1.x 升级到 2.2.x 以上不能完美升级最好重新安装

### v2.3.94
updated 2019.8.21

- 增加: 小助手插件支持二维码logo生成
- 增加: 系统消息，支持行为异常提醒，请求异常提醒
- 增加: 数据迁移辅助类
- 增加: Echarts Widget 热点图
- 增加: 小助手插件支持数据迁移生成、Excel导入权限、省市区爬虫等功能，仅支持开发模式
- 增加: api登出功能 [@0xDarker](https://github.com/0xDarker)
- 增加: 权限检查支持 urlManager 中配置的路由规则 [@0xDarker](https://github.com/0xDarker)
- 优化: Gii生成Curd，可自定义表单组件生成和首页显示
- 优化: Gii生成Model，字段注释信息可直接当字段说明来用
- 优化: EasyWechat的缓存改成Yii2的缓存
- 优化: 日志的详情格式化输出数据
- 优化: 应用id存储的数据表字段名称(不向前兼容)
- 优化: 插件的安装/卸载/更新，支持Yii2自带的数据库操作类和数据迁移方式
- 优化: 缓存前缀统一带上商户ID
- 修复: 授权角色插件权限下菜单参数丢失
- 修复: 角色更新状态失败
- 修复: COS 初始化失败
- 修复: 独立图片域名情况下，上传图片微信服务器报错
- 修复: 全局配置如果复选框或者单选框未选择情况不提交数据
- 修复: 删除权限未删除已分配的权限的子权限
- 修复: 生成支付回调Url有多余的商家id导致验签失败
- 修复: 系统探针个别php环境下，导致崩溃 [@kbdxbt](https://github.com/kbdxbt)
- 修复: 导入数据找不到时间戳和生成md文档默认值为数组报错 [@kbdxbt](https://github.com/kbdxbt)
- 修复: 权限批量校验bug [@0xDarker](https://github.com/0xDarker)
- 替换: 数据迁移扩展源为 `jianyan74/yii2-console-migration` 修复json字段情况下报错数据格式错误
- 替换: TreeGrid扩展源为 `jianyan74/yii2-treegrid` 修复父id非0情况下显示错误
- 移动: 数据备份还原到小助手插件
- 移动: 系统探针到小助手插件
- 升级: Yii2版本到2.0.25

### v2.3.65
updated 2019.7.29

- 增加: 行为Url动态监控记录敏感日志
- 增加: IP黑名单验证，设置后所有应用都不可访问
- 增加: 全局日志异常报表统计和短信发送异常报表统计
- 增加: 文件上传黑名单后缀验证
- 增加: 文件/图片上传的 OSS js直传(不可以全局使用该驱动)
- 增加: 文件/图片上传 md5 验证实现秒传
- 增加: Url辅助类的 oauth2 和 storage 应用生成
- 增加: Echarts Widget 支持折线图/柱状图/饼图
- 增加: Auth 权限判断支持通配符 *，例如使用 `/*`、`/goods/*`等等
- 增加: 微信消息表情包解析
- 优化: 行为日志记录，更加全面的方便的记录信息
- 优化: 用户积分/余额变动服务
- 优化: 插件安装生成入口和菜单，支持参数生成传递(老的插件需要重新创建)
- 优化: oauth2 支持 windows 环境下进行开发测试
- 优化: 选择图片中的上传驱动和当前上传的一致
- 优化: 后台 Gii 一键生成 Curd
- 优化: 基础 Model 和查询 Model 位置，注意升级需统一替换路径
- 优化: 图片裁剪 widget 支持图片选择和多图片裁剪
- 优化: 短信发送日志报错记录
- 优化: 文件上传进度条显示
- 修复: base64文件上传到服务器追加导致失败
- 修复: 上传文件路径某些情况下会多一个 http 前缀
- 修复: 分片上传多个大文件时候会出现找不到文件错误
- 修复: TreeGrid 下删除Url填写错误
- 合并: upload.css 统一到 rageframe.widget.css
- 升级: Yii2版本到2.0.23

### v2.3.39
updated 2019.6.28

- 增加: 增加个人信息内登录登出日志显示
- 增加: 地区选择(商城省市区选择)Widget
- 增加: 地图经纬度选择(百度、高德、腾讯)Widget
- 增加: 图片裁剪上传Widget
- 增加: 增加配置管理类型Input组
- 增加: 功能案例的Model展示
- 增加: 腾讯COS对象存储上传
- 增加: 用Iframe进行表单提交功能和案例
- 增加: TreeGrid 表单控件
- 增加: 插件支持引导文件，一些预加载的方法都可在引导类里面执行
- 增加: oauth2应用(授权码模式、简化模式、密码模式、客户端模式、刷新access_token)，支持对外部api开放
- 增加: 支持多商户数据库字段和代码结构
- 增加: 短信日志
- 增加: 自定义权限支持前台/Api/Wechat端权限控制
- 增加: 充值日志
- 增加: 会员后台直接充值积分/余额
- 优化: 顶部导航栏的消息通知为widget
- 优化: 系统内无极级分类都支持随意切换移动上级
- 优化: 整体的代码结构进行解耦，计算查询部分迁移至Services层
- 优化: UI细节，更加友好
- 优化: 微信视频的同步支持同步视频详情
- 优化: 定时发送的创建更加友好
- 优化: 自动回复的的创建更加友好
- 优化: 微信/支付宝支付成功的回调
- 优化: 上传组件(图片、视频、语音、文件)支持多主题且支持自由增加主题
- 优化: 插件模块的安装、卸载、升级功能
- 优化: 插件模块的路由，使其更加简洁
- 优化: 数据库字段text类型存储的改为json类型
- 优化: UI细节方面关于输入框、标签、按钮等
- 优化: 原本的页面Tree渲染替换为TreeGrid表单控件
- 合并：插件权限和系统权限管理
- 合并：自动回复的表结构统一融入规则表内
- 修复: 模块关键字触发找不到控制器的BUG
- 修复: 微信粉丝标签无法删除
- 修复: 上传文件由于触发被动回调导致报错
- 修复: 解析IP辅助类解析失败
- 更换: Yii2自带的rbac为自定义的rbac
- 升级: 后台主题 AminLTE 版本为 2.4.10
- 升级: Yii2版本到2.0.21

### v2.2.52
updated 2019.6.2

- 修复: 菜单下拉偶尔会出现样式失调的情况
- 修复: 模拟框打开时间/日期控件的时候关闭异常

### v2.2.50
updated 2019.5.28

- 修复: Html辅助类变量名称错误
- 修复: Auth辅助类逻辑错误
- 修复: 某些情况下初始化密码会出现重复显示字符串
- 修复: 插件权限判断未定义在插件内导致判断错误

### v2.2.46
updated 2019.5.20

- 增加: 省市区三级联动可自由显示级别，例如只需要省市
- 优化: 会员表和用户模型名称
- 优化: 一些文件的命名
- 优化: 修改密码退出效果
- 合并: `AuthHelper` 和 `AddonAuthHelper` 做到插件和系统校验无感切换
- 合并: `HtmlHelper `和 `AddonHtmlHelper` 做到插件和系统无感切换
- 合并: `UrlHelper `和 `AddonUrlHelper` 做到插件和系统无感切换
- 修复: 百度编辑器 ajax model 渲染只渲染一次的问题
- 修复: ExcleHelper辅助类导出报格式错误
- 移动: 服务层 `services` 到根目录
- 移除: 默认路由 `.html` 后缀

### v2.2.35
updated 2019.3.27

- 修复: gii生成curd的首页报错
- 修复: 文档服务层单词错误
- 修复: api的token命名错误

### v2.2.32
updated 2019.3.11

- 增加: ID加密辅助类 HashidsHelper
- 优化: 图片/文件选择和微信资源选择
- 优化: 插件模块的应用入口生成二维码改为jq生成，加快生成速度
- 修复: 卸载插件模块时未卸载规则关键字
- 修复: 插件模块Url辅助类不支持 string 类型生成
- 修复: js组件fancybox多图浏览时候动画失调
- 修复: 数据迁移报错
- 修复: api下用户信息 sex 字段未更改为 gender 字段的bug
- 修复: 微信素材选择第一次可能会出现无法选中的情况
- 修复: 公用支付扩展由于版本落后导致报错
- 升级: Yii2版本到2.0.16.1

### v2.2.21
updated 2019.2.18

- 增加: 插件模块权限辅助类，来支持页面路由验证
- 增加: 系统权限辅助类，来支持页面路由验证
- 增加: 后台Tag页签选择，支持单页面
- 增加: 系统公告和私信
- 增加: 兼容IE9的js
- 修复: IE浏览器下刷新按钮链接过去错误
- 修复: 后台个人资料头像裁剪失败
- 修复: 百度编辑器config的toolbars配置数组合并与实际不符
- 修复: Html辅助类权限判断数组报错
- 优化: 微信授权登录为Trait类，方便插件模块或其他地方调用
- 优化: 权限校验查找
- 优化: 后台UI主题色彩
- 优化: 模拟框的显示后初始化
- 优化: 页面上面一些秘钥权限的块不进行显示
- 优化: 数据库的一些字段
- 优化: 系统css/js的加载
- 优化: 微信、微信支付、小程序等配置从启动文件直接配置
- 升级: Yii2版本到2.0.16
- 移除: 后台主题风格记录到数据库

### v2.2.2
updated 2019.1.17

- 修复: 文件选择时 psd 文件显示错误
- 修复: 导航标签关闭时会出现剩余标签显示不全的情况
- 替换: 当前的后台主题为 AminLTE 2.4.5

### v2.1.41
updated 2019.1.11

- 增加: 配置应用独立域名的支持
- 增加: 文件上传记录到数据库内
- 增加: 内容管理幻灯片及接口和文档
- 增加: 本地图像支持在线图像动态处理(缩略图/压缩/翻转等等)
- 增加: 文件存储应用
- 增加: 图片/文件上传在线选择功能
- 增加: 只显示权限可见的插件模块菜单
- 增加: 主动发送(客服)消息支持视频/图片/图文/音频
- 修复: 当只有默认菜单，没有个性化菜单时，官方返回的数据上没有menuid导致报错
- 修复: 同步个性化菜单，获取组别标签失败
- 修复: 更新图文消息失败
- 优化: 不在对上传的中文名进行转码读取，避免出现不会报错的情况
- 优化: api速率控制为缓存读取
- 优化: api的报错返回，不渲染页面再返回
- 优化: api等权限校验逻辑，校验判断绑定到方法中
- 优化: 百度编辑器在线选择图片/文件
- 优化: 微信素材列表瀑布流显示
- 优化: 微信素材编辑百度编辑器在线选择图片列表为微信图片列表
- 优化: 上传辅助类来支持未来更多的辅助功能
- 优化: 插件模块的导航和菜单配置生成判断
- 更换: 定时任务组件为 `omnilight/yii2-scheduling`
- 重构: 微信选择图片/语音/视频/图文，修改为widget方式调用
- 移除: `2amigos/yii2-date-time-picker-widget` 扩展 如需使用看文档 表单控件 有替换组件

### v2.1.18
updated 2018.12.28

- 增加: 插件模块权限管理
- 增加: 插件模块路由名称改为Yii2的风格
- 增加: 网站配置日期、时间、日期时间、复选框选项
- 增加: 新增/编辑/删除管理员、角色都被记录到行为日志
- 增加: api接口除了token验证还支持签名验证，可一键开启
- 增加: Html辅助类和插件Html模块辅助类
- 增加: 后台菜单支持参数传递
- 增加: 发送短信服务支持消息队列
- 修复: 菜单分类删除报错
- 修复: 插件模块 Grid 排序调整错误
- 修复: 小程序登录重置控制器生成日志路径错误
- 修复: 超出可视区域的时候头像截取不全的情况
- 修复: 插件模块多级目录下控制器使用 Url 短路由会出现识别路径错误的情况
- 修复: Mac环境情况下开启了 ipv6 导致系统检索ip地址失败出现的超时
- 优化: api登录重置功能
- 优化: 代码注释，让IDE开发智能提示更加友好
- 优化: 用户删除、用户地址、用户第三方授权信息删除都为伪删除
- 优化: 系统权限管理，更加符合用户需求
- 优化: 后台管理员操作流程，子角色管理员只可看见自己下属的管理员
- 迁移: 碎片管理中的日志为服务层内
- 移除: 码云webhook钩子的api接口及配置信息
- 移除: xunsearch 扩展 如果需要请自行安装，案例可在示例管理插件查看

### v2.0.96
updated 2018.12.7

- 增加: 下载微信临时资源文件Demo
- 增加: 报错日志服务支持队列
- 增加: 发送邮件服务支持队列
- 增加: 显示第三方绑定会员信息
- 增加: Base64格式图片上传到Oss/七牛
- 增加: 百度编辑器远程图片上传到Oss/七牛
- 修复: 关闭 Tag 页签时点击菜单不会重新加载菜单页面
- 修复: 后台头像编辑时候每次打开关闭会让样式往左不会复原
- 修复: 系统服务内 __get 方法内判断子服务类型错误
- 优化: 文件上传的Oss/七牛对象存储的接管上传方式
- 兼容: Grid 多主键的 Curd 状态修改

### v2.0.85
updated 2018.11.29

- 增加: 发送文字消息给微信粉丝
- 增加: 百度编辑器Oss/Qiniu上传，目前只支持文件/图片/视频
- 增加: 百度编辑器可拉取远程图片然后上传到本地
- 增加: Ffmpeg辅助类，提供提取视频信息转码等
- 优化: 微信接口报错机制，获取错误信息更加友好
- 优化: 插件模块后台必须登录才可访问
- 修复: 删除权限/菜单分类时未删除其全部子权限/菜单
- 修复: 实例化插件模块前未关闭csrf，导致插件模块内的csrf关闭/开启无效
- 修复: 文件辅助类的日志写入创建地址问题
- 修复: Windows下微信语音中文名上传报错

### v2.0.75
updated 2018.11.22

- 增加: 多图上传/多文件上传支持拖动排序
- 增加: 插件模块的钩子(hook)支持多个hook方法
- 增加: 示例模块的 Grid 案例
- 优化: 代码的规范和命名规则
- 优化: api日志记录改成全局日志，支持 wechat/backend/frontend 报错记录
- 修复: 插件模块下自带的ajax更新找不到id

### v2.0.69
updated 2018.11.16

- 优化: api日志记录，增加记录级别更好的进行区分报错
- 优化: 插件模块的资源目录，更加友好的区分前后台微信的资源，且和Yii2资源结构保持一致
- 修复: 修改菜单默认显示时候，未干掉其他正在显示的菜单
- 修复: 开启上传前缀时，百度编辑器选择在线管理的附件/图片前缀为空
- 修复: 角色授权显示时候，会把顶级分类下面的所有子分类都选中

### v2.0.64
updated 2018.11.10

- 增加: 微信定时发送
- 增加: 前台 i18n 国际化Demo
- 增加: 前台 第三方登录 Demo
- 增加: 无权限菜单不显示
- 优化: 微信自定义回复的语音和视频选择
- 优化: 省市区数据为最新的2017.10.31的国家统计局省市区数据
- 优化: 前台关于图片上传的js和css引入，避免资源依赖找不到
- 优化: 插件模块查询机制, 增加数据缓存依赖，依赖时间为 360 秒
- 优化: 文件上传的处理
- 优化: 分片上传的文件合并机制
- 修复: Windows下百度编辑器查找文件列表中文编码报错
- 修复: Windows下上传文件中文名报错
- 修复: 网站配置的多图上传引入路径错误
- 修复: 定时任务路径问题导致执行失败

### v2.0.50
updated 2018.11.1

- 增加: 公用支付的银联支付及文档
- 增加: Api二次加密验证机制Demo
- 增加: `购物节` 模块的微信分享Demo，需手动开启
- 增加: `示例管理`模块的Api入口Demo
- 增加: 服务层调用Demo及说明文档
- 优化: 必填文本框Css显示及一些页面小优化
- 优化: Api的登录机制，支持多端登录(app/微信/小程序等)
- 优化: 插件模块路由机制，支持多级控制器目录
- 优化: 插件模块 hook 查询机制减少模块内重复调用的数据查询
- 优化: Excel导出辅助类，优化填写header错误导致报错
- 修复: 插件模块左边菜单过长导致显示不全
- 修复: 插件模块Api入口 `POST/PUT/DELETE` 等方法访问失败

### v2.0.38
updated 2018.10.17

- 增加: JS方法提供内页打开新标签页面
- 优化: 自动回复的图片回复选择方式
- 优化: 自动回复的图文回复选择方式
- 修复: 第三方授权的字段名错误导致用户数据插入失败

### v2.0.34
updated 2018.10.15

- 增加: 内容管理插件的前台显示Demo
- 增加: 会员积分/余额变动日志接口
- 增加: 插件模块 `购物节` 签到抽奖微信页面的Demo
- 优化: 插件模块的Hook渲染报错机制
- 修复: 小程序解析数据变量重复导致获取不到session信息
- 修复: 第三方授权的字段名错误导致验证失败

### v2.0.28
updated 2018.10.10

- 优化: Api解耦速率控制，可自由选择是否被速率控制

### v2.0.27
updated 2018.10.10

- 优化: 缓存清理各个应用的缓存文件夹读写判断
- 优化: 后台总管理员安全权限，初始化安装时随机总管理员的账号密码
- 修复: Linux环境下创建插件报找不到模板文件
- 修复: Excel导入找不到最后一列数据

### v2.0.23
updated 2018.9.30

- 增加: 图片上传可压缩图片质量，从 `common/config/params` 里面配置
- 增加: 图片水印，从 `common/config/params` 里面配置
- 增加: 示例管理模块的消息队列、ElasticSearch、默认搜索 的 Demo
- 优化: 子权限账号后台权限名称显示
- 修复: 角色权限授权采用了jstree后，折叠顶级节点的时候无法获取到子节点

### v2.0.18
updated 2018.9.26

- 增加: 示例管理模块 `MongoDB` 的 Curd，如需测试请自行安装 php 的 mongodb 扩展和 MongoDb 环境
- 优化: 多图上传的显示样式及功能
- 优化: 微信/小程序支付Demo，调整公用的回调控制器
- 修复: 由于上传视频和语音开启了全域名返回导致的上传到微信服务器错误
- 修复: 由于 api 的 controllerMap 位置不对导致的报错

### v2.0.13
updated 2018.9.21

- 增加: 扩展模块 `文章管理` 提供二开示例及使用
- 修复: 由于默认微信参数没有导致的自动回复报错
- 修复: 由于上传图片开启了全域名返回导致的上传到微信服务器错误
- 修复: 由于上传JS问题，导致了文件上传后删除时候不显示上传按钮
- 修复: 创建扩展模块时候资源目录为空引起的报错

### v2.0.8
updated 2018.9.18

- 增加: Url辅助类，用于生成前台、api、微信地址
- 修复: 权限验证时候路由规则的判断错误
- 修复: 控制台中执行 php yii 的报错
- 优化: 图片上传缩略图配置，可设置多个缩略图
- 优化: 角色权限授权，采用了jstree插件表现页面
- 优化: 增强安全机制，安装流程中增加初始化随机生成10位密码

### v2.0.2
updated 2018.9.10

- 2.0 全新上线

### v2.0.1
updated 2018.6.11

- 增加: IP地址转地区组件
- 增加: 大部分基础功能

### v2.0.0
updated 2018.5.20
 
 - 初始化: 2.0 基础框架